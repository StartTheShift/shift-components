angular.module("shift.components",["shift.components.sortable","shift.components.calendar","shift.components.selector","shift.components.typeahead","shift.components.popover","shift.components.select","shift.components.time","shift.components.floating","shift.components.tooltip"]),angular.module("shift.components.calendar",[]).directive("shiftCalendar",function(){return{restrict:"E",templateUrl:"calendar/calendar.html",require:"ngModel",scope:{date:"=ngModel",change:"&",validator:"=",highlight:"=",allowNull:"="},link:function(e){var t,n,o;return e.goToNextMonth=function(){return e.showing_date.add(1,"month"),t()},e.goToPreviousMonth=function(){return e.showing_date.subtract(1,"month"),t()},e.goToSelectedDate=function(){return e.showing_date=moment(e.date),t()},e.selectDate=function(e){var t;return t=moment(e.target.getAttribute("data-iso")),n(t)?o(t):void 0},e.setNull=function(){return e.allowNull?(e.date=null,t(),e.change()):void 0},n=function(t){return moment.isMoment(t)&&t.isValid()?null!=e.validator?e.validator(t):!0:!1},o=function(n){return e.date=n,e.showing_date=moment(n||void 0),t(),e.change()},e.$watch("date",function(e,t){return e!==t?o(e):void 0}),e.getClass=function(t){var o;return{active:null!=(o=e.date)?o.isSame(t,"day"):void 0,off:!e.showing_date.isSame(t,"month"),available:n(t),invalid:!n(t),highlight:"function"==typeof e.highlight?e.highlight(t):void 0}},(t=function(){var t,n,o,i,r,s,l;for(t=moment(e.showing_date).startOf("month").startOf("week"),i=moment(e.showing_date).endOf("month").endOf("week"),(null!=(r=e.date)&&"function"==typeof r.isValid?r.isValid():void 0)&&(t.set("hour",e.date.get("hour")),t.set("minute",e.date.get("minute")),t.set("second",e.date.get("second"))),e.weeks=[],s=[];;){if(o=t.day(),n=t.date(),0===o){if(e.weeks.length>5)break;l=[],e.weeks.push(l)}l.push({iso_8061:t.format(),day_of_the_month:n,date:moment(t)}),s.push(t.add(1,"day"))}return s})(),e.allowNull||moment.isMoment(e.date)||(e.date=moment()),moment.isMoment(e.date)?(o(e.date),e.showing_date=moment(e.date)):e.showing_date=moment().startOf("day")}}}),angular.module("shift.components.calendar").run(["$templateCache",function(e){e.put("calendar/calendar.html",'<div class="calendar"><table class="table-condensed"><thead><tr><th title="previous month" ng-click="goToPreviousMonth()"><i class="fa fa-chevron-left"></i></th><th><i ng-if="date" title="go to {{ date.format(\'MMMM Do, YYYY\') }}" ng-hide="showing_date.isSame(date, \'month\')" ng-click="goToSelectedDate()" class="fa fa-dot-circle-o"></i></th><th colspan="3" class="month">{{ showing_date.format(\'MMM YYYY\') }}</th><th><i title="Unset date" ng-click="setNull()" ng-if="date &amp;&amp; dateAllowNull" class="fa fa-times"></i></th><th title="next month" ng-click="goToNextMonth()"><i class="fa fa-chevron-right"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody ng-click="selectDate($event)"><tr ng-repeat="week in weeks track by $index"><td ng-repeat="day in week track by $index" ng-class="getClass(day.date)" data-iso="{{ day.iso_8061 }}">{{ day.day_of_the_month }}</td></tr></tbody></table></div>')}]),angular.module("shift.components.floating",[]).directive("shiftFloating",["$compile",function(e){return{restrict:"E",transclude:!0,scope:!0,link:function(t,n,o,i,r){var s,l,a,c,u,d,p;switch(u=!1,p=null,d=parseInt(o.offset,10)||0,s=o.parent&&t.$eval(o.parent)||n[0].parentNode,l=angular.element(document.createElement("div")),l.addClass("floating-container floating-"+(o.position||"left")),l.css({visibility:"hidden",top:0,left:0}),"fixed"in o&&l.attr({fixed:!0}),t.show=function(n){var i;if(!u)return u=!0,i=$(o.attachTo||"body"),l.empty(),l.append(r()),t.$apply(function(){return i.append(l),e(l)(t)}),setTimeout(function(){var e,t,n,i;switch($(l).offset($(s).offset()),n=$(l[0]).outerHeight(),i=$(l[0]).outerWidth(),e=$(s).outerHeight(),t=$(s).outerWidth(),o.position){case"top":return l.css({marginLeft:t/2-i/2+"px",marginTop:"-"+(n+d)+"px",visibility:""});case"bottom":return l.css({marginLeft:t/2-i/2+"px",marginTop:e+d+"px",visibility:""});case"right":return l.css({marginLeft:t+d+"px",marginTop:e/2-n/2+"px",visibility:""});default:return l.css({marginLeft:"-"+(i+d)+"px",marginTop:e/2-n/2+"px",visibility:""})}})},t.hide=function(){return u?(t.scrollSelector&&s.closest(t.scrollSelector).removeEventListener("scroll",monitorScroll),l.remove(),l.css({marginLeft:"",marginTop:"",visibility:"hidden"}),u=!1):void 0},a=function(e){var n;for(n=e.target;n;){if(n===l[0]||n===s)return;n=n.parentNode}return t.hide()},c=function(e){return 27===e.which?t.$apply(t.hide):void 0},o.trigger){case"hover":s.addEventListener("mouseenter",t.show),s.addEventListener("mouseout",t.hide),p=function(){return s.removeEventListener("mouseenter",t.show),s.removeEventListener("mouseout",t.hide)};break;case"focus":s.addEventListener("focus",t.show),s.addEventListener("blur",t.hide),p=function(){return s.removeEventListener("focus",t.show),s.removeEventListener("blur",t.hide)};break;default:s.addEventListener("click",t.show),document.addEventListener("click",a),document.addEventListener("keyup",c),p=function(){return s.removeEventListener("click",t.show),document.removeEventListener("click",a),document.addEventListener("keyup",c)}}return t.$on("$destroy",p)}}}]),angular.module("shift.components.popover",[]).directive("shiftPopover",["$http","$compile","$templateCache",function(e,t,n){var o;return o='<div class="popover-container">\n  <h3\n    ng-if = "title"\n    class = "popover-title">{{ title }}</h3>\n  <p>{{ text }}</p>\n</div>',{restrict:"A",scope:!0,link:function(i,r,s,l,a){var c,u;return i.parent_node=r[0],u=o,c=function(){var e;return e=angular.element("<shift-floating />"),i.title=s.shiftPopoverTitle,i.text=s.shiftPopover,e.attr({parent:"parent_node",attachTo:s.shiftPopoverattachTo,position:s.shiftPopoverPosition||"bottom",trigger:s.shiftPopoverTrigger||"click",offset:"5"}),s.fixed&&e.attr({fixed:!0}),e.html(u),void $("body").append(t(e)(i))},s.shiftPopoverTemplateUrl?e.get(s.shiftPopoverTemplateUrl,{cache:n}).then(function(e){return u='<div class="popover-container">'+e.data+"</div>",c()}):s.shiftPopoverTemplate?(u='<div class="popover-container">'+s.shiftPopoverTemplate+"</div>",c()):(c(),i.$watch(s.title,function(e,t){return e!==t?c():void 0}),i.$watch(s.text,function(e,t){return e!==t?c():void 0}))}}}]),angular.module("shift.components.select",["shift.components.selector"]).directive("shiftSelect",["$compile",function(e){return{restrict:"E",transclude:!0,templateUrl:"select/select.html",scope:{options:"=",option:"=",onSelect:"&",onDiscard:"&",placeholder:"@"},link:function(t,n,o,i,r){var s,l,a,c,u,d;return t.show_select=!1,a=angular.element(document.createElement("div")),a.attr({"ng-show":"option","class":"select-option"}),u=angular.element(document.createElement("shift-selector")),u.css({width:$(n[0].parentNode).outerWidth()+"px"}),u.attr({"class":"shift-selector",visible:"show_select",options:"options","on-select":"_onSelect(selected)","on-discard":"_onDiscard(discarded)"}),d=t.$new(),c=t.$new(),r(d,function(e){return u.append(e)}),r(c,function(e){return a.append(e)}),n.children().append(a),n.append(u),e(u)(d),e(a)(c),t._onDiscard=function(e){return t.show_select=!1,t.option=null,t.onDiscard({discarded:e})},t._onSelect=function(e){return t.onSelect({selected:e}),t.option=e,t.show_select=!1},t.show=function(){return t.show_select=!0},l=function(e){return 27===e.which?t.$apply(function(){return t.show_select=!1}):void 0},s=function(e){var o;for(o=e.target;null!=o?o.parentNode:void 0;){if(o===n[0])return;o=o.parentNode}return t.$apply(function(){return t.show_select=!1})},document.addEventListener("click",s),document.addEventListener("keyup",l),t.$on("$destroy",function(){return document.removeEventListener("click",s),document.removeEventListener("keyup",l)})}}}]),angular.module("shift.components.select").run(["$templateCache",function(e){e.put("select/select.html",'<div ng-click="show()" class="select-container"><div ng-if="!option" class="select-option">{{ placeholder }}</div></div>')}]);var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("shift.components.selector",[]).directive("shiftSelector",["$compile",function(e){var t,n,o;return o=38,t=40,n=13,{restrict:"E",transclude:!0,scope:{options:"=",visible:"=",selected:"=?",onSelect:"&",onDiscard:"&"},link:function(i,r,s,l,a){var c,u,d,p,h,f,m,v;return f=angular.element(document.createElement("ul")),f.addClass("select-list"),f.attr({"ng-if":"visible && options.length"}),p=angular.element(document.createElement("li")),p.attr({"ng-repeat":"option in options","ng-class":"getClass($index)","ng-click":"toggle($index, $event)","ng-mouseenter":"setPosition($index, $event)"}),a(i,function(e,t){return p.append(e)}),f.append(p),r.append(f),e(f)(i),e(p)(i),i.position=-1,null!=s.multiple&&null==i.selected&&(i.selected=[]),d=function(e){var r,s;if((null!=(s=i.options)?s.length:void 0)&&i.visible&&(r=e.which||e.keyCode,r===o||r===t||r===n))return i.$apply(function(){switch(r){case o:i.position-=1;break;case t:i.position+=1;break;default:i.position>-1&&i.toggle(i.position,e)}return i.position=Math.max(0,i.position),i.position=Math.min(i.options.length-1,i.position),c()}),e.preventDefault(),e.stopPropagation(),!1},c=function(){var e,t,n,o,s,l;return e=r[0].children[0],o=e.children[i.position],s=o.getBoundingClientRect(),t=e.getBoundingClientRect(),l=getComputedStyle(o),s.bottom>t.bottom&&(n=parseInt(l.marginBottom,10),e.scrollTop+=s.bottom-t.bottom+n),s.top<t.top?(n=parseInt(l.marginTop,10),e.scrollTop+=s.top-t.top-n):void 0},u=function(e){return null!=s.multiple?indexOf.call(i.selected,e)>=0:e===i.selected},i.toggle=function(e,t){return t.stopPropagation(),p=i.options[e],u(p)?i.discard(e):i.select(e),!1},i.select=function(e){var t;return i.position=e,t=i.options[i.position],null!=s.multiple?i.selected.push(t):i.selected=t,i.onSelect({selected:t})},i.discard=function(e){var t;return i.position=e,t=i.options[i.position],null!=s.multiple?_.pull(i.selected,t):i.selected=null,i.onDiscard({discarded:t})},h=0,i.setPosition=function(e,t){return t.clientY!==h?(h=t.clientY,i.position=e):void 0},i.getClass=function(e){var t;return{selected:u(null!=(t=i.options)?t[e]:void 0),active:e===i.position}},(m=function(){return document.addEventListener("keydown",d)})(),v=function(){return document.removeEventListener("keydown",d)},i.$on("$destroy",v)}}}]);var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("shift.components.sortable",[]).service("shiftSortableService",function(){var e;return e={},{register:function(t,n,o){return null==e[t]&&(e[t]=[]),e[t].push({container:n,scope:o}),e[t]}}}).directive("shiftSortable",["shiftSortableService",function(e){return{restrict:"A",scope:{shiftSortable:"=",shiftSortableChange:"&",shiftSortableAdd:"&",shiftSortableRemove:"&",shiftSortableHandle:"@",shiftSortableNamespace:"@"},link:function(t,n,o){var i,r,s,l,a,c,u,d,p,h,f,m,v,g;return i=n[0],r=null,g=null,a=null,d={},f=document.createElement("div"),f.className="placeholder",t.shiftSortableNamespace&&(v=e.register(t.shiftSortableNamespace,i,t)),s=function(e,t,o){var i,r,s,l,a,p;for(l=e.children[e.children.length-1],p=e.children,s=r=0,a=p.length;a>r;s=++r)if(n=p[s],i=n.getBoundingClientRect(),u(t,o,i))return c(t,o,i)?n:n===l?d:e.children[s+1]},c=function(e,t,n){var o,i;return t-=$(window).scrollTop(),e-=$(window).scrollLeft(),o=e-n.left,i=n.top+n.height-t,i>o/n.width*n.height},u=function(e,t,n){return t-=$(window).scrollTop(),e-=$(window).scrollLeft(),e>n.left&&e<n.right&&t>n.top&&t<n.bottom},l=function(e){var n;if(n=e.target,null!=t.shiftSortableHandle){if(!n.matches(t.shiftSortableHandle))return;for(;n.parentNode!==i;)n=n.parentNode}return e.preventDefault(),indexOf.call(i.children,n)>=0&&(r=n,g=$(r).index(),f.style.width=r.clientWidth+"px",f.style.height=r.clientHeight+"px",r.style.minWidth=$(r).width()+"px",r.style.minHeight=$(r).height()+"px",window.addEventListener("mousemove",p),window.addEventListener("mouseup",m),i.insertBefore(f,r),document.body.appendChild(r),$(r).addClass("dragging"),p(e)),!1},p=function(e){var n,o,s,l;if(e.preventDefault(),r.style.left=e.pageX-10+"px",r.style.top=e.pageY-10+"px",t.shiftSortableNamespace){for(s=[],n=0,o=v.length;o>n;n++)l=v[n],s.push(h(l.container,e));return s}return h(i,e)},h=function(e,t){var n;return u(t.pageX,t.pageY,e.getBoundingClientRect())?(0===e.children.length?e.appendChild(f):(n=s(e,t.pageX,t.pageY),null!=n&&(n===d?e.appendChild(f):n!==a&&(a=n,e.insertBefore(f,n)))),!1):!1},m=function(e){var n,o,s,l,a,c,u,d,h;if(s=$(f).index(),o=f.parentNode,n=o!==i,c=s!==g,$(r).removeClass("dragging"),n||c||o.insertBefore(r,f),o.removeChild(f),r.style.left=f.style.width=r.style.minWidth="",r.style.top=f.style.height=r.style.minHeight="",r=null,window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m),n){for(u=null,t.$apply(function(){return u=t.shiftSortable.splice(g,1)[0],t.shiftSortableChange(),t.shiftSortableRemove({item:u})}),d=[],l=0,a=v.length;a>l;l++)h=v[l],d.push(h.container===o?h.scope.$apply(function(){return h.scope.shiftSortable.splice(s,0,u),h.scope.shiftSortableChange(),h.scope.shiftSortableAdd({item:u})}):void 0);return d}return c?t.$apply(function(){return u=t.shiftSortable.splice(g,1)[0],t.shiftSortable.splice(s,0,u),t.shiftSortableChange()}):void 0},i.addEventListener("mousedown",l),t.$on("$destroy",function(){return i.removeEventListener("mousedown",l),v?_.remove(v,function(e){return e.scope===t}):void 0})}}}]),angular.module("shift.components.tooltip",[]).directive("shiftTooltip",["$http","$compile","$templateCache",function(e,t,n){var o;return o='<div class="tooltip-container">{{ text }}</div>',{restrict:"A",scope:{text:"@shiftTooltip",position:"@shiftTooltipPosition",trigger:"@shiftTooltipTrigger",attachTo:"@shiftTooltipattachTo"},link:function(e,n,i,r,s){var l;return e.parent_node=n[0],(l=function(){var n;return n=angular.element("<shift-floating />"),n.attr({parent:"parent_node",attachTo:e.attachTo,position:e.position||"top",trigger:e.trigger||"hover",offset:"2"}),i.fixed&&n.attr({fixed:!0}),n.append(t(o)(e)),void $("body").append(t(n)(e))})(),e.$watch(i.title,function(e,t){return e!==t?l():void 0})}}}]);var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("shift.components.time",[]).directive("shiftTime",["$timeout",function(e){return{require:"ngModel",restrict:"A",scope:{time:"=ngModel"},link:function(t,n,o,i){var r;return r=function(e){var t,n,o,i,r;return i=/(1[0-2]|0?[1-9])[^ap\d]?([0-5][0-9]|[0-9])?\s?(am|pm|a|p)?/,r=i.exec(e.toLowerCase()),r?(t=r[1]&&parseInt(r[1],10)||0,n=r[2]&&parseInt(r[2],10)||0,"p"===(o=r[3])||"pm"===o?12>t&&(t+=12):12===t&&(t=0),[t,n]):[0,0]},i.$formatters.push(function(e){return e?moment(e).format("h:mm a"):""}),i.$parsers.push(function(e){var n,o,i,s;return e?(s=r(e),n=s[0],o=s[1],i=moment(t.time).set("hour",n).set("minute",o)):t.time}),n.on("blur",function(n){var o;if(t.time&&t.time.isValid())return o=n.target.value,indexOf.call(moment(t.time).format("h:mm a"),o)<0?e(function(){return t.time=moment(t.time)}):void 0})}}}]),angular.module("shift.components.typeahead",["shift.components.selector"]).directive("shiftTypeahead",["$compile","$filter",function(e,t){return{restrict:"E",transclude:!0,templateUrl:"typeahead/typeahead.html",scope:{source:"=",filterAttribute:"@",selected:"=",onOptionSelect:"&",onOptionDeselect:"&",placeholder:"@",show_options_on_focus:"=showOptionsOnFocus",show_select_menu:"=?showSelectMenu",close_menu_on_esc:"=closeMenuOnEsc"},link:function(n,o,i,r,s){var l,a,c,u,d,p,h,f;return n.options=[],null==n.show_select_menu&&(n.show_select_menu=!1),n.onSelectMultiOption=function(e){return n.onOptionSelect({option:e})},n.onDeselectMultiOption=function(e){return n.onOptionDeselect({option:e})},d=angular.element(document.createElement("shift-selector")),o.addClass("popover active"),d.attr({visible:"show_select_menu && !selected",options:"options",selected:"selected","on-select":"onSelect(selected)","ng-mousedown":"mouseDown(true)","ng-mouseup":"mouseDown(false)"}),null!=i.multiselect&&d.attr({multiple:"true","on-select":"onSelectMultiOption(selected)","on-discard":"onDeselectMultiOption(discarded)",visible:"show_select_menu"}),p=n.$new(),s(p,function(e){return d.append(e)}),o.append(d),e(d)(p),l=function(){var e;return n.query?(e={},e[n.filterAttribute]=n.query,n.options=t("filter")(n.source,e).slice(0,6),n.show_select_menu=!0):n.options=[]},a=!1,n.mouseDown=function(e){return a=e},n.hide=function(e){return a?void 0:n.show_select_menu=!1},n.onFocus=function(e){return n.show_select_menu=!0,n.show_options_on_focus?n.query?l():n.options=n.source:void 0},n.onSelect=function(e){return n.selected=e,n.query=null!=e?e[n.filterAttribute]:void 0},n.$watch("query",function(e,t){var o;if(e!==t)return null==i.multiselect&&n.query!==(null!=(o=n.selected)?o[n.filterAttribute]:void 0)&&(n.selected=null),l()}),c=function(e){var t;return t=e.which||e.keyCode,n.close_menu_on_esc&&27===t&&n.show_select_menu?(e.stopPropagation(),n.$apply(function(){return n.show_select_menu=!1})):void 0},u=function(e){n.show_select_menu&&(o.has(e.target).length||n.$apply(function(){return n.show_select_menu=!1}))},(h=function(){return document.addEventListener("keyup",c),null!=i.multiselect?document.addEventListener("mousedown",u):void 0})(),f=function(){return document.removeEventListener("keyup",c),document.removeEventListener("mousedown",u)},n.$on("$destroy",f)}}}]),angular.module("shift.components.typeahead").run(["$templateCache",function(e){e.put("typeahead/typeahead.html",'<div class="typeahead"><div class="clear-icon"></div><div class="search-icon"></div><input type="text" ng-blur="hide($event)" ng-focus="onFocus($event)" ng-model="query" placeholder="{{placeholder}}"></div>')}]);
//# sourceMappingURL=shift-components.min.js.map