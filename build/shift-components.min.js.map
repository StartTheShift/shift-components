{"version":3,"sources":["shift-components.js"],"names":["angular","module","directive","restrict","templateUrl","scope","date","dateChange","dateValidator","dateHightlight","dateAllowNull","link","buildCalendarScope","isValidDate","updateDate","goToNextMonth","showing_date","add","goToPreviousMonth","subtract","goToSelectedDate","moment","selectDate","$event","target","getAttribute","setNull","isMoment","isValid","$watch","new_value","old_value","getClass","ref","active","isSame","off","available","invalid","highlight","day_of_the_month","day_of_the_week","end_date","results","week","startOf","endOf","weeks","day","length","push","iso_8061","format","run","$templateCache","put","$compile","DOWN_KEY","ENTER_KEY","UP_KEY","transclude","options","selected","onSelect","element","attrs","ctrl","autoScroll","onKeyDown","option","select_container","startListening","stopListening","document","createElement","addClass","attr","ng-if","ng-repeat","ng-class","ng-click","ng-mouseenter","clone","append","position","event","key_code","which","keyCode","$apply","select","Math","max","min","preventDefault","stopPropagation","container_elt","container_pos","option_elt","option_pos","children","getBoundingClientRect","bottom","scrollTop","top","index","setPosition","$index","addEventListener","removeEventListener","$on","indexOf","item","i","l","this","shiftSortable","shiftSortableChange","shiftSortableHandle","container","dragging","getElementAt","grab","hovered_element","isBefore","isInside","last_element","move","placeholder","release","start_position","className","x","y","coord","last","len","rectange","rel_x","rel_y","$","window","scrollLeft","left","height","width","right","matches","parentElement","call","style","clientWidth","clientHeight","minWidth","minHeight","insertBefore","body","appendChild","elt","pageX","pageY","end_position","removeClass","removeChild","record","splice","$filter","source","filterAttribute","filterOptions","mouse_down","shift_select","shift_select_scope","ng-show","on-select","ng-mousedown","ng-mouseup","$new","filter","query","slice","mouseDown","is_down","hide","show_select_menu"],"mappings":"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","file":"shift-components.min.js","sourcesContent":["\n/**\nUI components for SHIFT applications\n\n@requires momentJS\n@requires lodash\n@requires jQuery\n@requires shift.components.sortable\n@requires shift.components.calendar\n@requires shift.components.select\n@requires shift.components.typeahead\n\n@module shift.components\n\n@link sortable/\n */\nangular.module('shift.components', ['shift.components.sortable', 'shift.components.calendar', 'shift.components.select', 'shift.components.typeahead']);\n\n\n/**\nCalendar directive displays the date and changes it on click.\n\nNote that moment(moment_object) is heavily used to clone a date instead of\njust passing the reference (since date is a moment object). It allows simpler\ndate handeling without the the risk of impacting associated dates.\n\n@module shift.components.calendar\n\n@requires momentJS\n@requires lodash\n\n@param {moment} date A moment object, default to now\n@param {function} dateChange Called when date is changed\n@param {function} dateValidator Method returning a Boolean indicating if\nthe selected date is valid or not\n@param {function} dateHightlight Method returning a Boolean to highlight\na days on the calendar.\n@param {Boolean} dateAllowNull Indicate if the date can be set to null\n\n@example\n```jade\nshift-calendar(\n  date = \"date\"\n  date-change = \"onDateChange(date)\"\n  date-validator = \"isValidDate\"\n  date-highlight = \"isSpecialDay\"\n  date-allow-null = \"true\"\n)\n```\n */\nangular.module('shift.components.calendar', []).directive('shiftCalendar', function() {\n  return {\n    restrict: 'E',\n    templateUrl: 'calendar/calendar.html',\n    scope: {\n      date: '=',\n      dateChange: '&',\n      dateValidator: '=',\n      dateHightlight: '=',\n      dateAllowNull: '='\n    },\n    link: function(scope) {\n      var buildCalendarScope, isValidDate, updateDate;\n      scope.goToNextMonth = function() {\n        scope.showing_date.add(1, 'month');\n        return buildCalendarScope();\n      };\n      scope.goToPreviousMonth = function() {\n        scope.showing_date.subtract(1, 'month');\n        return buildCalendarScope();\n      };\n      scope.goToSelectedDate = function() {\n        scope.showing_date = moment(scope.date);\n        return buildCalendarScope();\n      };\n      scope.selectDate = function($event) {\n        return updateDate(moment($event.target.getAttribute('data-iso')));\n      };\n      scope.setNull = function() {\n        if (!scope.dateAllowNull) {\n          return;\n        }\n        scope.date = null;\n        buildCalendarScope();\n        return scope.dateChange();\n      };\n      isValidDate = function(date) {\n        if (!(moment.isMoment(date) && date.isValid())) {\n          return false;\n        }\n        if (scope.dateValidator != null) {\n          return scope.dateValidator(date);\n        }\n        return true;\n      };\n      updateDate = function(date) {\n        if (isValidDate(date)) {\n          scope.date = date;\n          scope.showing_date = moment(date);\n          buildCalendarScope();\n          return scope.dateChange();\n        }\n      };\n      scope.$watch('date', function(new_value, old_value) {\n        if (new_value === old_value) {\n          return;\n        }\n        return updateDate(new_value);\n      });\n      scope.getClass = function(date) {\n        var ref;\n        return {\n          active: (ref = scope.date) != null ? ref.isSame(date, 'day') : void 0,\n          off: !scope.showing_date.isSame(date, 'month'),\n          available: isValidDate(date),\n          invalid: !isValidDate(date),\n          highlight: typeof scope.dateHightlight === \"function\" ? scope.dateHightlight(date) : void 0\n        };\n      };\n      (buildCalendarScope = function() {\n        var date, day_of_the_month, day_of_the_week, end_date, results, week;\n        date = moment(scope.showing_date).startOf('month').startOf('week');\n        end_date = moment(scope.showing_date).endOf('month').endOf('week');\n        scope.weeks = [];\n        results = [];\n        while (true) {\n          day_of_the_week = date.day();\n          day_of_the_month = date.date();\n          if (day_of_the_week === 0) {\n            if (scope.weeks.length > 5) {\n              break;\n            }\n            week = [];\n            scope.weeks.push(week);\n          }\n          week.push({\n            iso_8061: date.format(),\n            day_of_the_month: day_of_the_month,\n            date: moment(date)\n          });\n          results.push(date.add(1, 'day'));\n        }\n        return results;\n      })();\n      if (!scope.dateAllowNull && !moment.isMoment(scope.date)) {\n        scope.date = moment();\n      }\n      if (moment.isMoment(scope.date)) {\n        updateDate(scope.date);\n        return scope.showing_date = moment(scope.date);\n      } else {\n        return scope.showing_date = moment().startOf('day');\n      }\n    }\n  };\n});\n\n'use strict';\n\nangular.module('shift.components.calendar').run(['$templateCache', function($templateCache) {\n\n  $templateCache.put('calendar/calendar.html', '<div class=\"calendar\"><table class=\"table-condensed\"><thead><tr><th title=\"previous month\" ng-click=\"goToPreviousMonth()\"><i class=\"fa fa-chevron-left\"></i></th><th><i ng-if=\"date\" title=\"go to {{ date.format(\\'MMMM Do, YYYY\\') }}\" ng-hide=\"showing_date.isSame(date, \\'month\\')\" ng-click=\"goToSelectedDate()\" class=\"fa fa-dot-circle-o\"></i></th><th colspan=\"3\" class=\"month\">{{ showing_date.format(\\'MMM YYYY\\') }}</th><th><i title=\"Unset date\" ng-click=\"setNull()\" ng-if=\"date &amp;&amp; dateAllowNull\" class=\"fa fa-times\"></i></th><th title=\"next month\" ng-click=\"goToNextMonth()\"><i class=\"fa fa-chevron-right\"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody ng-click=\"selectDate($event)\"><tr ng-repeat=\"week in weeks track by $index\"><td ng-repeat=\"day in week track by $index\" ng-class=\"getClass(day.date)\" data-iso=\"{{ day.iso_8061 }}\">{{ day.day_of_the_month }}</td></tr></tbody></table></div>');\n\n}]);\n\n/**\nA directive that displays a list of option, navigation using arrow\nkeys + enter or mouse click.\n\nThe options are not displayed anymore if selected has a value or if\noptions is emtpy.\n\n@module shift.components.select\n\n@param {array} options Options to be displayed and to choose from\n@param {object} selected Object selected from the options\n@param {function} onSelect Callback triggered when an option has been selected\n\n@example\n```jade\n  shift-select(\n    options = \"options\"\n    selected = \"selected\"\n    on-select = \"onSelect(selected)\"\n  )\n    strong {{option.city}}\n    span &nbsp; {{option.state}}\n    div\n      i pop. {{option.population}}\n```\n */\nangular.module('shift.components.select', []).directive('shiftSelect', function($compile) {\n  var DOWN_KEY, ENTER_KEY, UP_KEY;\n  UP_KEY = 38;\n  DOWN_KEY = 40;\n  ENTER_KEY = 13;\n  return {\n    restrict: 'E',\n    transclude: true,\n    scope: {\n      options: '=',\n      selected: '=',\n      onSelect: '&'\n    },\n    link: function(scope, element, attrs, ctrl, transclude) {\n      var autoScroll, onKeyDown, option, select_container, startListening, stopListening;\n      select_container = angular.element(document.createElement('div'));\n      select_container.addClass('select-container');\n      select_container.attr({\n        'ng-if': '!selected && options.length'\n      });\n      option = angular.element(document.createElement('div'));\n      option.addClass('select-option');\n      option.attr({\n        'ng-repeat': 'option in options',\n        'ng-class': 'getClass($index)',\n        'ng-click': 'select($index)',\n        'ng-mouseenter': 'setPosition($index)'\n      });\n      transclude(scope, function(clone, scope) {\n        return option.append(clone);\n      });\n      select_container.append(option);\n      element.append(select_container);\n      $compile(select_container)(scope);\n      $compile(option)(scope);\n      scope.position = -1;\n      onKeyDown = function(event) {\n        var key_code, ref;\n        if (!((ref = scope.options) != null ? ref.length : void 0)) {\n          return;\n        }\n        key_code = event.which || event.keyCode;\n        if (key_code !== UP_KEY && key_code !== DOWN_KEY && key_code !== ENTER_KEY) {\n          return;\n        }\n        scope.$apply(function() {\n          switch (key_code) {\n            case UP_KEY:\n              scope.position -= 1;\n              break;\n            case DOWN_KEY:\n              scope.position += 1;\n              break;\n            default:\n              if (scope.position > -1) {\n                scope.select(scope.position);\n              }\n          }\n          scope.position = Math.max(0, scope.position);\n          scope.position = Math.min(scope.options.length - 1, scope.position);\n          return autoScroll();\n        });\n        event.preventDefault();\n        event.stopPropagation();\n        return false;\n      };\n      autoScroll = function() {\n        var container_elt, container_pos, option_elt, option_pos;\n        container_elt = element[0].children[0];\n        option_elt = container_elt.children[scope.position];\n        option_pos = option_elt.getBoundingClientRect();\n        container_pos = container_elt.getBoundingClientRect();\n        if (option_pos.bottom > container_pos.bottom) {\n          container_elt.scrollTop += option_pos.bottom - container_pos.bottom;\n        }\n        if (option_pos.top < container_pos.top) {\n          return container_elt.scrollTop += option_pos.top - container_pos.top;\n        }\n      };\n      scope.select = function(index) {\n        scope.position = index;\n        scope.selected = scope.options[scope.position];\n        return scope.onSelect({\n          selected: scope.selected\n        });\n      };\n      scope.setPosition = function($index) {\n        return scope.position = $index;\n      };\n      scope.getClass = function(index) {\n        return {\n          'selected': index === scope.position\n        };\n      };\n      (startListening = function() {\n        return document.addEventListener('keydown', onKeyDown);\n      })();\n      stopListening = function() {\n        return document.removeEventListener('keydown', onKeyDown);\n      };\n      scope.$on('$destroy', stopListening);\n      return void 0;\n    }\n  };\n});\n\n\n/**\nSortable directive to allow drag n' drop sorting of an array.\n\n@module shift.components.sortable\n\n@requires momentJS\n@requires lodash\n\n@param {array} shiftSortable Array of sortable object\n@param {function} shiftSortableChange Called when order is changed\n@param {string} shiftSortableHandle CSS selector to grab the element (optional)\n\n@example\n```jade\nul(\n  shift-sortable = \"list_of_object\"\n  shift-sortable-change = \"onListOrderChange(list_of_object)\"\n  shift-sortable-handle = \".grab-icon\"\n)\n  li(ng-repeat = \"element in list_of_object\") {{ element.name }}\n```\n */\nvar indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nangular.module('shift.components.sortable', []).directive('shiftSortable', function() {\n  return {\n    restrict: 'A',\n    scope: {\n      shiftSortable: '=',\n      shiftSortableChange: '&',\n      shiftSortableHandle: '@'\n    },\n    link: function(scope, element, attrs) {\n      var container, dragging, getElementAt, grab, hovered_element, isBefore, isInside, last_element, move, placeholder, release, start_position;\n      container = element[0];\n      dragging = null;\n      start_position = null;\n      hovered_element = null;\n      last_element = {};\n      placeholder = document.createElement('div');\n      placeholder.className = 'placeholder';\n      getElementAt = function(x, y) {\n        var coord, i, index, last, len, ref;\n        last = container.children[container.children.length - 1];\n        ref = container.children;\n        for (index = i = 0, len = ref.length; i < len; index = ++i) {\n          element = ref[index];\n          coord = element.getBoundingClientRect();\n          if (isInside(x, y, coord)) {\n            if (isBefore(x, y, coord)) {\n              return element;\n            } else if (element === last) {\n              return last_element;\n            } else {\n              return container.children[index + 1];\n            }\n          }\n        }\n      };\n      isBefore = function(x, y, rectange) {\n        var rel_x, rel_y;\n        y -= $(window).scrollTop();\n        x -= $(window).scrollLeft();\n        rel_x = x - rectange.left;\n        rel_y = rectange.top + rectange.height - y;\n        return rel_y > (rel_x / rectange.width) * rectange.height;\n      };\n      isInside = function(x, y, rectange) {\n        y -= $(window).scrollTop();\n        x -= $(window).scrollLeft();\n        return x > rectange.left && x < rectange.right && y > rectange.top && y < rectange.bottom;\n      };\n      grab = function(event) {\n        var target;\n        event.preventDefault();\n        target = event.target;\n        if (scope.shiftSortableHandle != null) {\n          if (!target.matches(scope.shiftSortableHandle)) {\n            return;\n          }\n          while (target.parentElement !== container) {\n            target = target.parentElement;\n          }\n        }\n        if (indexOf.call(container.children, target) >= 0) {\n          dragging = target;\n          start_position = $(dragging).index();\n          placeholder.style.width = dragging.clientWidth + \"px\";\n          placeholder.style.height = dragging.clientHeight + \"px\";\n          dragging.style.minWidth = ($(dragging).width()) + \"px\";\n          dragging.style.minHeight = ($(dragging).height()) + \"px\";\n          window.addEventListener('mousemove', move);\n          window.addEventListener('mouseup', release);\n          container.insertBefore(placeholder, dragging);\n          document.body.appendChild(dragging);\n          $(dragging).addClass('dragging');\n          move(event);\n        }\n        return false;\n      };\n      move = function(event) {\n        var elt;\n        event.preventDefault();\n        dragging.style.left = (event.pageX - 10) + \"px\";\n        dragging.style.top = (event.pageY - 10) + \"px\";\n        if (!isInside(event.pageX, event.pageY, container.getBoundingClientRect())) {\n          return false;\n        }\n        elt = getElementAt(event.pageX, event.pageY);\n        if (elt != null) {\n          if (elt === last_element) {\n            container.appendChild(placeholder);\n          } else if (elt !== hovered_element) {\n            hovered_element = elt;\n            container.insertBefore(placeholder, elt);\n          }\n        }\n        return false;\n      };\n      release = function(event) {\n        var end_position;\n        end_position = $(placeholder).index();\n        $(dragging).removeClass('dragging');\n        container.insertBefore(dragging, placeholder);\n        container.removeChild(placeholder);\n        dragging.style.left = placeholder.style.width = dragging.style.minWidth = '';\n        dragging.style.top = placeholder.style.height = dragging.style.minHeight = '';\n        dragging = null;\n        window.removeEventListener('mousemove', move);\n        window.removeEventListener('mouseup', release);\n        if (end_position !== start_position) {\n          return scope.$apply(function() {\n            var record;\n            record = scope.shiftSortable.splice(start_position, 1)[0];\n            scope.shiftSortable.splice(end_position, 0, record);\n            return scope.shiftSortableChange();\n          });\n        }\n      };\n      return container.addEventListener('mousedown', grab);\n    }\n  };\n});\n\n\n/**\nTypeahead directive displaying a set of option to choose from as input changes.\n\nThe transcluded object attributes are prepend with `option.`. In the case of the\nexample, the sources are\n\n```coffee\n$scope.sources = [\n  {state: 'ca', city: 'Los Angeles', population: 3884307}\n  ...\n]\n```\n\nin the transcluded template section, you would then access the population information\nthrough `{{ option.population }}`\n\n@module shift.components.typeahead\n\n@requires shift.components.select\n\n@param {array} sources Source of options to be filtered by the input\n@param {string} filterAttribute Name of the attribute for the filter\n@param {object} selected Object selected within the source\n\n@example\n```jade\nshift-typeahead(\n  sources = \"list_of_object\"\n  filterAttribute = \"city\"\n  selected = \"selected_city\"\n)\n  strong {{option.city}}\n  span &nbsp; {{option.state}}\n  div\n    i pop. {{option.population}}\n```\n */\nangular.module('shift.components.typeahead', ['shift.components.select']).directive('shiftTypeahead', function($compile, $filter) {\n  return {\n    restrict: 'E',\n    transclude: true,\n    templateUrl: 'typeahead/typeahead.html',\n    scope: {\n      source: '=',\n      filterAttribute: '@',\n      selected: '='\n    },\n    link: function(scope, element, attrs, ctrl, transclude) {\n      var filterOptions, mouse_down, shift_select, shift_select_scope;\n      shift_select = angular.element(document.createElement('shift-select'));\n      shift_select.attr({\n        'ng-show': 'show_select_menu',\n        'options': 'options',\n        'selected': 'selected',\n        'on-select': 'onSelect(selected)',\n        'ng-mousedown': 'mouseDown(true)',\n        'ng-mouseup': 'mouseDown(false)'\n      });\n      shift_select_scope = scope.$new();\n      transclude(shift_select_scope, function(clone) {\n        return shift_select.append(clone);\n      });\n      element.append(shift_select);\n      $compile(shift_select)(shift_select_scope);\n      filterOptions = function() {\n        var filter;\n        if (scope.query) {\n          filter = {};\n          filter[scope.filterAttribute] = scope.query;\n          return scope.options = $filter('filter')(scope.source, filter).slice(0, 6);\n        } else {\n          return scope.options = [];\n        }\n      };\n      mouse_down = false;\n      scope.mouseDown = function(is_down) {\n        return mouse_down = is_down;\n      };\n      scope.hide = function($event) {\n        if (!mouse_down) {\n          return scope.show_select_menu = false;\n        }\n      };\n      scope.onSelect = function(selected) {\n        scope.selected = selected;\n        return scope.query = selected != null ? selected[scope.filterAttribute] : void 0;\n      };\n      return scope.$watch('query', function(new_value, old_value) {\n        var ref;\n        if (new_value === old_value) {\n          return;\n        }\n        if (scope.query !== ((ref = scope.selected) != null ? ref[scope.filterAttribute] : void 0)) {\n          scope.selected = null;\n        }\n        return filterOptions();\n      });\n    }\n  };\n});\n\n'use strict';\n\nangular.module('shift.components.typeahead').run(['$templateCache', function($templateCache) {\n\n  $templateCache.put('typeahead/typeahead.html', '<input type=\"text\" ng-blur=\"hide($event)\" ng-focus=\"show_select_menu = true\" ng-model=\"query\">');\n\n}]);"],"sourceRoot":"/source/"}