{"version":3,"sources":["shift-components.js"],"names":["angular","module","directive","restrict","templateUrl","scope","date","dateChange","dateValidator","dateHightlight","dateAllowNull","link","buildCalendarScope","isValidDate","updateDate","goToNextMonth","showing_date","add","goToPreviousMonth","subtract","goToSelectedDate","moment","selectDate","$event","target","getAttribute","setNull","isMoment","isValid","$watch","new_value","old_value","getClass","ref","active","isSame","off","available","invalid","highlight","day_of_the_month","day_of_the_week","end_date","results","week","startOf","endOf","weeks","day","length","push","iso_8061","format","run","$templateCache","put","$compile","transclude","options","option","onSelect","onDiscard","placeholder","element","attrs","ctrl","onDocumentClick","onKeyup","shift_selected","shift_selected_scope","shift_selector","shift_selector_scope","show_select","document","createElement","attr","ng-show","class","on-select","on-discard","$new","clone","append","children","_onDiscard","discarded","_onSelect","selected","show","event","which","$apply","parentNode","addEventListener","$on","removeEventListener","indexOf","item","i","l","this","DOWN_KEY","ENTER_KEY","UP_KEY","autoScroll","isSelected","onKeyDown","previous_client_y","select_container","startListening","stopListening","addClass","ng-if","ng-repeat","ng-class","ng-click","ng-mouseenter","position","multiple","key_code","keyCode","toggle","Math","max","min","preventDefault","stopPropagation","container_elt","container_pos","margin","option_elt","option_pos","option_style","getBoundingClientRect","getComputedStyle","bottom","parseInt","marginBottom","scrollTop","top","marginTop","call","index","discard","select","_","pull","setPosition","$index","clientY","service","namespaces","register","namespace","container","shiftSortableService","shiftSortable","shiftSortableChange","shiftSortableAdd","shiftSortableRemove","shiftSortableHandle","shiftSortableNamespace","dragging","getElementAt","grab","hovered_element","isBefore","isInside","last_element","move","movePlaceholder","release","sortables","start_position","className","x","y","coord","last","len","rectange","rel_x","rel_y","$","window","scrollLeft","left","height","width","right","matches","style","clientWidth","clientHeight","minWidth","minHeight","insertBefore","body","appendChild","sortable","pageX","pageY","elt","container_changed","drop_container","end_position","position_changed","record","removeClass","removeChild","splice","remove","$filter","source","filterAttribute","onOptionSelect","onOptionDeselect","show_options_on_focus","show_select_menu","close_menu_on_esc","filterOptions","mouse_down","onKeyUp","onMouseDown","select_menu","shift_select_scope","onSelectMultiOption","onDeselectMultiOption","ng-mousedown","ng-mouseup","multiselect","filter","query","slice","mouseDown","is_down","hide","onFocus","key","has"],"mappings":"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","file":"shift-components.min.js","sourcesContent":["\n/**\nUI components for SHIFT applications\n\n@requires momentJS\n@requires lodash\n@requires jQuery\n@requires shift.components.sortable\n@requires shift.components.calendar\n@requires shift.components.select\n@requires shift.components.typeahead\n@requires shift.components.select\n\n@module shift.components\n\n@link sortable/\n */\nangular.module('shift.components', ['shift.components.sortable', 'shift.components.calendar', 'shift.components.selector', 'shift.components.typeahead', 'shift.components.select']);\n\n\n/**\nCalendar directive displays the date and changes it on click.\n\nNote that moment(moment_object) is heavily used to clone a date instead of\njust passing the reference (since date is a moment object). It allows simpler\ndate handeling without the the risk of impacting associated dates.\n\n@module shift.components.calendar\n\n@requires momentJS\n@requires lodash\n\n@param {moment} date A moment object, default to now\n@param {function} dateChange Called when date is changed\n@param {function} dateValidator Method returning a Boolean indicating if\nthe selected date is valid or not\n@param {function} dateHightlight Method returning a Boolean to highlight\na days on the calendar.\n@param {Boolean} dateAllowNull Indicate if the date can be set to null\n\n@example\n```jade\nshift-calendar(\n  date = \"date\"\n  date-change = \"onDateChange(date)\"\n  date-validator = \"isValidDate\"\n  date-highlight = \"isSpecialDay\"\n  date-allow-null = \"true\"\n)\n```\n */\nangular.module('shift.components.calendar', []).directive('shiftCalendar', function() {\n  return {\n    restrict: 'E',\n    templateUrl: 'calendar/calendar.html',\n    scope: {\n      date: '=',\n      dateChange: '&',\n      dateValidator: '=',\n      dateHightlight: '=',\n      dateAllowNull: '='\n    },\n    link: function(scope) {\n      var buildCalendarScope, isValidDate, updateDate;\n      scope.goToNextMonth = function() {\n        scope.showing_date.add(1, 'month');\n        return buildCalendarScope();\n      };\n      scope.goToPreviousMonth = function() {\n        scope.showing_date.subtract(1, 'month');\n        return buildCalendarScope();\n      };\n      scope.goToSelectedDate = function() {\n        scope.showing_date = moment(scope.date);\n        return buildCalendarScope();\n      };\n      scope.selectDate = function($event) {\n        return updateDate(moment($event.target.getAttribute('data-iso')));\n      };\n      scope.setNull = function() {\n        if (!scope.dateAllowNull) {\n          return;\n        }\n        scope.date = null;\n        buildCalendarScope();\n        return scope.dateChange();\n      };\n      isValidDate = function(date) {\n        if (!(moment.isMoment(date) && date.isValid())) {\n          return false;\n        }\n        if (scope.dateValidator != null) {\n          return scope.dateValidator(date);\n        }\n        return true;\n      };\n      updateDate = function(date) {\n        if (isValidDate(date)) {\n          scope.date = date;\n          scope.showing_date = moment(date);\n          buildCalendarScope();\n          return scope.dateChange();\n        }\n      };\n      scope.$watch('date', function(new_value, old_value) {\n        if (new_value === old_value) {\n          return;\n        }\n        return updateDate(new_value);\n      });\n      scope.getClass = function(date) {\n        var ref;\n        return {\n          active: (ref = scope.date) != null ? ref.isSame(date, 'day') : void 0,\n          off: !scope.showing_date.isSame(date, 'month'),\n          available: isValidDate(date),\n          invalid: !isValidDate(date),\n          highlight: typeof scope.dateHightlight === \"function\" ? scope.dateHightlight(date) : void 0\n        };\n      };\n      (buildCalendarScope = function() {\n        var date, day_of_the_month, day_of_the_week, end_date, results, week;\n        date = moment(scope.showing_date).startOf('month').startOf('week');\n        end_date = moment(scope.showing_date).endOf('month').endOf('week');\n        scope.weeks = [];\n        results = [];\n        while (true) {\n          day_of_the_week = date.day();\n          day_of_the_month = date.date();\n          if (day_of_the_week === 0) {\n            if (scope.weeks.length > 5) {\n              break;\n            }\n            week = [];\n            scope.weeks.push(week);\n          }\n          week.push({\n            iso_8061: date.format(),\n            day_of_the_month: day_of_the_month,\n            date: moment(date)\n          });\n          results.push(date.add(1, 'day'));\n        }\n        return results;\n      })();\n      if (!scope.dateAllowNull && !moment.isMoment(scope.date)) {\n        scope.date = moment();\n      }\n      if (moment.isMoment(scope.date)) {\n        updateDate(scope.date);\n        return scope.showing_date = moment(scope.date);\n      } else {\n        return scope.showing_date = moment().startOf('day');\n      }\n    }\n  };\n});\n\n'use strict';\n\nangular.module('shift.components.calendar').run(['$templateCache', function($templateCache) {\n\n  $templateCache.put('calendar/calendar.html', '<div class=\"calendar\"><table class=\"table-condensed\"><thead><tr><th title=\"previous month\" ng-click=\"goToPreviousMonth()\"><i class=\"fa fa-chevron-left\"></i></th><th><i ng-if=\"date\" title=\"go to {{ date.format(\\'MMMM Do, YYYY\\') }}\" ng-hide=\"showing_date.isSame(date, \\'month\\')\" ng-click=\"goToSelectedDate()\" class=\"fa fa-dot-circle-o\"></i></th><th colspan=\"3\" class=\"month\">{{ showing_date.format(\\'MMM YYYY\\') }}</th><th><i title=\"Unset date\" ng-click=\"setNull()\" ng-if=\"date &amp;&amp; dateAllowNull\" class=\"fa fa-times\"></i></th><th title=\"next month\" ng-click=\"goToNextMonth()\"><i class=\"fa fa-chevron-right\"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody ng-click=\"selectDate($event)\"><tr ng-repeat=\"week in weeks track by $index\"><td ng-repeat=\"day in week track by $index\" ng-class=\"getClass(day.date)\" data-iso=\"{{ day.iso_8061 }}\">{{ day.day_of_the_month }}</td></tr></tbody></table></div>');\n\n}]);\n\n/**\nA directive to mimic HTML select but awesome.\n\n@module shift.components.select\n\n@param {array} options Options to be displayed and to choose from\n@param {object} option Option selected\n@param {function} onSelect Callback triggered when an option has been selected\n@param {function} onDiscard Callback triggered when an option has been de-selected\n@param {string} placeholder Text to display when no option are selected\n\n@example\n```jade\n  shift-select(\n    options = \"options\"\n    option = \"selected_option\"\n    on-select = \"onSelect(selected)\"\n    on-discard = \"onDiscard(discarded)\"\n    placeholder = \"Click to make a selection...\"\n  )\n    strong {{option.city}}, {{ option.state }}\n    div\n      i pop. {{option.population}}\n```\n */\nangular.module('shift.components.select', ['shift.components.selector']).directive('shiftSelect', ['$compile', function($compile) {\n  return {\n    restrict: 'E',\n    transclude: true,\n    templateUrl: 'select/select.html',\n    scope: {\n      options: '=',\n      option: '=',\n      onSelect: '&',\n      onDiscard: '&',\n      placeholder: '@'\n    },\n    link: function(scope, element, attrs, ctrl, transclude) {\n      var onDocumentClick, onKeyup, shift_selected, shift_selected_scope, shift_selector, shift_selector_scope;\n      scope.show_select = false;\n      shift_selected = angular.element(document.createElement('div'));\n      shift_selected.attr({\n        'ng-show': 'option',\n        'class': 'select-option'\n      });\n      shift_selector = angular.element(document.createElement('shift-selector'));\n      shift_selector.attr({\n        'ng-show': 'show_select',\n        'options': 'options',\n        'on-select': '_onSelect(selected)',\n        'on-discard': '_onDiscard(discarded)'\n      });\n      shift_selector_scope = scope.$new();\n      shift_selected_scope = scope.$new();\n      transclude(shift_selector_scope, function(clone) {\n        return shift_selector.append(clone);\n      });\n      transclude(shift_selected_scope, function(clone) {\n        return shift_selected.append(clone);\n      });\n      element.children().append(shift_selected);\n      element.append(shift_selector);\n      $compile(shift_selector)(shift_selector_scope);\n      $compile(shift_selected)(shift_selected_scope);\n      scope._onDiscard = function(discarded) {\n        scope.show_select = false;\n        scope.option = null;\n        return scope.onDiscard({\n          discarded: discarded\n        });\n      };\n      scope._onSelect = function(selected) {\n        scope.onSelect({\n          selected: selected\n        });\n        scope.option = selected;\n        return scope.show_select = false;\n      };\n      scope.show = function() {\n        return scope.show_select = true;\n      };\n      onKeyup = function(event) {\n        if (event.which === 27) {\n          return scope.$apply(function() {\n            return scope.show_select = false;\n          });\n        }\n      };\n      onDocumentClick = function(event) {\n        var target;\n        target = event.target;\n        while (target != null ? target.parentNode : void 0) {\n          if (target === element[0]) {\n            return;\n          }\n          target = target.parentNode;\n        }\n        return scope.$apply(function() {\n          return scope.show_select = false;\n        });\n      };\n      document.addEventListener('click', onDocumentClick);\n      document.addEventListener('keyup', onKeyup);\n      return scope.$on('$destroy', function() {\n        document.removeEventListener('click', onDocumentClick);\n        return document.removeEventListener('keyup', onKeyup);\n      });\n    }\n  };\n}]);\n\n'use strict';\n\nangular.module('shift.components.select').run(['$templateCache', function($templateCache) {\n\n  $templateCache.put('select/select.html', '<div ng-click=\"show()\" class=\"select-container\"><div ng-if=\"!option\" class=\"select-option\">{{ placeholder }}</div></div>');\n\n}]);\n\n/**\nA directive that displays a list of option, navigation using arrow\nkeys + enter or mouse click.\n\nThe options are not displayed anymore if selected has a value or if\noptions is emtpy.\n\n@module shift.components.selector\n\n@param {array} options Options to be displayed and to choose from\n@param {object} selected Object selected from the options\n@param {function} onSelect Callback triggered when an option has been selected\n@param {function} onDiscard Callback triggered when an option has de-selected\n@param {boolean} multiple Indicates if the selection allows selection of more\nthan one option\n\n@example\n```jade\n  shift-selector(\n    options = \"options\"\n    selected = \"selected\"\n    on-select = \"onSelect(selected)\"\n    on-discard = \"onDiscard(discarded)\"\n    multiple\n  )\n    strong {{option.city}}\n    span &nbsp; {{option.state}}\n    div\n      i pop. {{option.population}}\n```\n */\nvar indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nangular.module('shift.components.selector', []).directive('shiftSelector', ['$compile', function($compile) {\n  var DOWN_KEY, ENTER_KEY, UP_KEY;\n  UP_KEY = 38;\n  DOWN_KEY = 40;\n  ENTER_KEY = 13;\n  return {\n    restrict: 'E',\n    transclude: true,\n    scope: {\n      options: '=',\n      selected: '=?',\n      onSelect: '&',\n      onDiscard: '&'\n    },\n    link: function(scope, element, attrs, ctrl, transclude) {\n      var autoScroll, isSelected, onKeyDown, option, previous_client_y, select_container, startListening, stopListening;\n      select_container = angular.element(document.createElement('div'));\n      select_container.addClass('select-container');\n      select_container.attr({\n        'ng-if': 'options.length'\n      });\n      option = angular.element(document.createElement('div'));\n      option.addClass('select-option');\n      option.attr({\n        'ng-repeat': 'option in options',\n        'ng-class': 'getClass($index)',\n        'ng-click': 'toggle($index, $event)',\n        'ng-mouseenter': 'setPosition($index, $event)'\n      });\n      transclude(scope, function(clone, scope) {\n        return option.append(clone);\n      });\n      select_container.append(option);\n      element.append(select_container);\n      $compile(select_container)(scope);\n      $compile(option)(scope);\n      scope.position = -1;\n      if (attrs.multiple != null) {\n        if (scope.selected == null) {\n          scope.selected = [];\n        }\n      }\n      onKeyDown = function(event) {\n        var key_code, ref;\n        if (!((ref = scope.options) != null ? ref.length : void 0)) {\n          return;\n        }\n        key_code = event.which || event.keyCode;\n        if (key_code !== UP_KEY && key_code !== DOWN_KEY && key_code !== ENTER_KEY) {\n          return;\n        }\n        scope.$apply(function() {\n          switch (key_code) {\n            case UP_KEY:\n              scope.position -= 1;\n              break;\n            case DOWN_KEY:\n              scope.position += 1;\n              break;\n            default:\n              if (scope.position > -1) {\n                scope.toggle(scope.position, event);\n              }\n          }\n          scope.position = Math.max(0, scope.position);\n          scope.position = Math.min(scope.options.length - 1, scope.position);\n          return autoScroll();\n        });\n        event.preventDefault();\n        event.stopPropagation();\n        return false;\n      };\n      autoScroll = function() {\n        var container_elt, container_pos, margin, option_elt, option_pos, option_style;\n        container_elt = element[0].children[0];\n        option_elt = container_elt.children[scope.position];\n        option_pos = option_elt.getBoundingClientRect();\n        container_pos = container_elt.getBoundingClientRect();\n        option_style = getComputedStyle(option_elt);\n        if (option_pos.bottom > container_pos.bottom) {\n          margin = parseInt(option_style.marginBottom, 10);\n          container_elt.scrollTop += option_pos.bottom - container_pos.bottom + margin;\n        }\n        if (option_pos.top < container_pos.top) {\n          margin = parseInt(option_style.marginTop, 10);\n          return container_elt.scrollTop += option_pos.top - container_pos.top - margin;\n        }\n      };\n      isSelected = function(option) {\n        if (attrs.multiple != null) {\n          return indexOf.call(scope.selected, option) >= 0;\n        }\n        return option === scope.selected;\n      };\n      scope.toggle = function(index, event) {\n        event.stopPropagation();\n        option = scope.options[index];\n        if (isSelected(option)) {\n          scope.discard(index);\n        } else {\n          scope.select(index);\n        }\n        return false;\n      };\n      scope.select = function(index) {\n        var selected;\n        scope.position = index;\n        selected = scope.options[scope.position];\n        if (attrs.multiple != null) {\n          scope.selected.push(selected);\n        } else {\n          scope.selected = selected;\n        }\n        return scope.onSelect({\n          selected: selected\n        });\n      };\n      scope.discard = function(index) {\n        var discarded;\n        scope.position = index;\n        discarded = scope.options[scope.position];\n        if (attrs.multiple != null) {\n          _.pull(scope.selected, discarded);\n        } else {\n          scope.selected = null;\n        }\n        return scope.onDiscard({\n          discarded: discarded\n        });\n      };\n      previous_client_y = 0;\n      scope.setPosition = function($index, event) {\n        if (event.clientY !== previous_client_y) {\n          previous_client_y = event.clientY;\n          return scope.position = $index;\n        }\n      };\n      scope.getClass = function(index) {\n        var ref;\n        return {\n          'selected': isSelected((ref = scope.options) != null ? ref[index] : void 0),\n          'active': index === scope.position\n        };\n      };\n      (startListening = function() {\n        return document.addEventListener('keydown', onKeyDown);\n      })();\n      stopListening = function() {\n        return document.removeEventListener('keydown', onKeyDown);\n      };\n      return scope.$on('$destroy', stopListening);\n    }\n  };\n}]);\n\n\n/**\nSortable directive to allow drag n' drop sorting of an array.\n\n@module shift.components.sortable\n\n@requires momentJS\n@requires lodash\n\n@param {array} shiftSortable Array of sortable object\n@param {function} shiftSortableChange Called when order is changed\n@param {function} shiftSortableAdd Called when an item gets added with\nthe added item as argument (`item` keyword is mandatory)\n@param {function} shiftSortableRemove Called when an item gets removed with\nthe removed item as argument (`item` keyword is mandatory)\n@param {string} shiftSortableHandle CSS selector to grab the element (optional)\n@param {string} shiftSortableNamespace Namespace for to define multiple possible\nsource and destinations.\n\n@example\n```jade\nul(\n  shift-sortable = \"list_of_object\"\n  shift-sortable-change = \"onListOrderChange(list_of_object)\"\n  shift-sortable-handle = \".grab-icon\"\n  shift-sortable-namespace = \"bucket_list\"\n)\n  li(ng-repeat = \"element in list_of_object\") {{ element.name }}\n\nul(\n  shift-sortable = \"list_of_object_excluded\"\n  shift-sortable-add = \"onListAdd(item)\"\n  shift-sortable-remove = \"onListRemove(item)\"\n  shift-sortable-handle = \".grab-icon\"\n  shift-sortable-namespace = \"bucket_list\"\n)\n  li(ng-repeat = \"element in list_of_object_excluded\") {{ element.name }}\n```\n */\nvar indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nangular.module('shift.components.sortable', []).service('shiftSortableService', function() {\n  var namespaces;\n  namespaces = {};\n  return {\n    register: function(namespace, container, scope) {\n      if (namespaces[namespace] == null) {\n        namespaces[namespace] = [];\n      }\n      namespaces[namespace].push({\n        container: container,\n        scope: scope\n      });\n      return namespaces[namespace];\n    }\n  };\n}).directive('shiftSortable', ['shiftSortableService', function(shiftSortableService) {\n  return {\n    restrict: 'A',\n    scope: {\n      shiftSortable: '=',\n      shiftSortableChange: '&',\n      shiftSortableAdd: '&',\n      shiftSortableRemove: '&',\n      shiftSortableHandle: '@',\n      shiftSortableNamespace: '@'\n    },\n    link: function(scope, element, attrs) {\n      var container, dragging, getElementAt, grab, hovered_element, isBefore, isInside, last_element, move, movePlaceholder, placeholder, release, sortables, start_position;\n      container = element[0];\n      dragging = null;\n      start_position = null;\n      hovered_element = null;\n      last_element = {};\n      placeholder = document.createElement('div');\n      placeholder.className = 'placeholder';\n      if (scope.shiftSortableNamespace) {\n        sortables = shiftSortableService.register(scope.shiftSortableNamespace, container, scope);\n      }\n      getElementAt = function(container, x, y) {\n        var coord, i, index, last, len, ref;\n        last = container.children[container.children.length - 1];\n        ref = container.children;\n        for (index = i = 0, len = ref.length; i < len; index = ++i) {\n          element = ref[index];\n          coord = element.getBoundingClientRect();\n          if (isInside(x, y, coord)) {\n            if (isBefore(x, y, coord)) {\n              return element;\n            } else if (element === last) {\n              return last_element;\n            } else {\n              return container.children[index + 1];\n            }\n          }\n        }\n      };\n      isBefore = function(x, y, rectange) {\n        var rel_x, rel_y;\n        y -= $(window).scrollTop();\n        x -= $(window).scrollLeft();\n        rel_x = x - rectange.left;\n        rel_y = rectange.top + rectange.height - y;\n        return rel_y > (rel_x / rectange.width) * rectange.height;\n      };\n      isInside = function(x, y, rectange) {\n        y -= $(window).scrollTop();\n        x -= $(window).scrollLeft();\n        return x > rectange.left && x < rectange.right && y > rectange.top && y < rectange.bottom;\n      };\n      grab = function(event) {\n        var target;\n        target = event.target;\n        if (scope.shiftSortableHandle != null) {\n          if (!target.matches(scope.shiftSortableHandle)) {\n            return;\n          }\n          while (target.parentNode !== container) {\n            target = target.parentNode;\n          }\n        }\n        event.preventDefault();\n        if (indexOf.call(container.children, target) >= 0) {\n          dragging = target;\n          start_position = $(dragging).index();\n          placeholder.style.width = dragging.clientWidth + \"px\";\n          placeholder.style.height = dragging.clientHeight + \"px\";\n          dragging.style.minWidth = ($(dragging).width()) + \"px\";\n          dragging.style.minHeight = ($(dragging).height()) + \"px\";\n          window.addEventListener('mousemove', move);\n          window.addEventListener('mouseup', release);\n          container.insertBefore(placeholder, dragging);\n          document.body.appendChild(dragging);\n          $(dragging).addClass('dragging');\n          move(event);\n        }\n        return false;\n      };\n      move = function(event) {\n        var i, len, results, sortable;\n        event.preventDefault();\n        dragging.style.left = (event.pageX - 10) + \"px\";\n        dragging.style.top = (event.pageY - 10) + \"px\";\n        if (scope.shiftSortableNamespace) {\n          results = [];\n          for (i = 0, len = sortables.length; i < len; i++) {\n            sortable = sortables[i];\n            results.push(movePlaceholder(sortable.container, event));\n          }\n          return results;\n        } else {\n          return movePlaceholder(container, event);\n        }\n      };\n      movePlaceholder = function(container, event) {\n        var elt;\n        if (!isInside(event.pageX, event.pageY, container.getBoundingClientRect())) {\n          return false;\n        }\n        if (container.children.length === 0) {\n          container.appendChild(placeholder);\n        } else {\n          elt = getElementAt(container, event.pageX, event.pageY);\n          if (elt != null) {\n            if (elt === last_element) {\n              container.appendChild(placeholder);\n            } else if (elt !== hovered_element) {\n              hovered_element = elt;\n              container.insertBefore(placeholder, elt);\n            }\n          }\n        }\n        return false;\n      };\n      release = function(event) {\n        var container_changed, drop_container, end_position, i, len, position_changed, record, results, sortable;\n        end_position = $(placeholder).index();\n        drop_container = placeholder.parentNode;\n        container_changed = drop_container !== container;\n        position_changed = end_position !== start_position;\n        $(dragging).removeClass('dragging');\n        if (!(container_changed || position_changed)) {\n          drop_container.insertBefore(dragging, placeholder);\n        }\n        drop_container.removeChild(placeholder);\n        dragging.style.left = placeholder.style.width = dragging.style.minWidth = '';\n        dragging.style.top = placeholder.style.height = dragging.style.minHeight = '';\n        dragging = null;\n        window.removeEventListener('mousemove', move);\n        window.removeEventListener('mouseup', release);\n        if (container_changed) {\n          record = null;\n          scope.$apply(function() {\n            record = scope.shiftSortable.splice(start_position, 1)[0];\n            scope.shiftSortableChange();\n            return scope.shiftSortableRemove({\n              item: record\n            });\n          });\n          results = [];\n          for (i = 0, len = sortables.length; i < len; i++) {\n            sortable = sortables[i];\n            if (sortable.container === drop_container) {\n              results.push(sortable.scope.$apply(function() {\n                sortable.scope.shiftSortable.splice(end_position, 0, record);\n                sortable.scope.shiftSortableChange();\n                return sortable.scope.shiftSortableAdd({\n                  item: record\n                });\n              }));\n            } else {\n              results.push(void 0);\n            }\n          }\n          return results;\n        } else if (position_changed) {\n          return scope.$apply(function() {\n            record = scope.shiftSortable.splice(start_position, 1)[0];\n            scope.shiftSortable.splice(end_position, 0, record);\n            return scope.shiftSortableChange();\n          });\n        }\n      };\n      container.addEventListener('mousedown', grab);\n      return scope.$on('$destroy', function() {\n        container.removeEventListener('mousedown', grab);\n        if (sortables) {\n          return _.remove(sortables, function(sortable) {\n            return sortable.scope === scope;\n          });\n        }\n      });\n    }\n  };\n}]);\n\n\n/**\nTypeahead directive displaying a set of option to choose from as input changes.\n\nThe transcluded object attributes are prepend with `option.`. In the case of the\nexample, the sources are\n\n```coffee\n$scope.sources = [\n  {state: 'ca', city: 'Los Angeles', population: 3884307}\n  ...\n]\n```\n\nin the transcluded template section, you would then access the population information\nthrough `{{ option.population }}`\n\n@module shift.components.typeahead\n\n@requires shift.components.selector\n\n@param {array} sources Source of options to be filtered by the input\n@param {string} filterAttribute Name of the attribute for the filter\n@param {object} selected Object selected within the source\n@param {function} onOptionSelect Invoked when a multiselect option is selected\n@param {function} onOptionDeselect Invoked when a multiselect option is deselected\n@param {string} placeholder Placeholder text for the input\n@param {bool} show_options_on_focus Open the select menu on focus\n@param {bool} show_selectmenu\n@param {bool} close_menu_on_esc Enable closing the menu with the escape key\n@param {string} multiselect An *attribute* to toggle shift-multiselect support\n\n@example\n```jade\nshift-typeahead(\n  sources = \"list_of_object\"\n  filterAttribute = \"city\"\n  selected = \"selected_city\"\n)\n  strong {{option.city}}\n  span &nbsp; {{option.state}}\n  div\n    i pop. {{option.population}}\n\n//- with multiselect enabled:\nshift-typeahead(\n  sources = \"list_of_object\"\n  filterAttribute = \"city\"\n  selected = \"selected_cities\"\n  multiselect\n)\n  label(for=\"shift_multiselect_option_{{$index}}\") {{option.city}}\n```\n */\nangular.module('shift.components.typeahead', ['shift.components.selector']).directive('shiftTypeahead', ['$compile', '$filter', function($compile, $filter) {\n  return {\n    restrict: 'E',\n    transclude: true,\n    templateUrl: 'typeahead/typeahead.html',\n    scope: {\n      source: '=',\n      filterAttribute: '@',\n      selected: '=',\n      onOptionSelect: '&',\n      onOptionDeselect: '&',\n      placeholder: '@',\n      show_options_on_focus: '=showOptionsOnFocus',\n      show_select_menu: '=?showSelectMenu',\n      close_menu_on_esc: '=closeMenuOnEsc'\n    },\n    link: function(scope, element, attrs, ctrl, transclude) {\n      var filterOptions, mouse_down, onKeyUp, onMouseDown, select_menu, shift_select_scope, startListening, stopListening;\n      scope.options = [];\n      if (scope.show_select_menu == null) {\n        scope.show_select_menu = false;\n      }\n      scope.onSelectMultiOption = function(option) {\n        return scope.onOptionSelect({\n          option: option\n        });\n      };\n      scope.onDeselectMultiOption = function(option) {\n        return scope.onOptionDeselect({\n          option: option\n        });\n      };\n      select_menu = angular.element(document.createElement('shift-selector'));\n      select_menu.attr({\n        'ng-show': 'show_select_menu && !selected',\n        'options': 'options',\n        'selected': 'selected',\n        'on-select': 'onSelect(selected)',\n        'ng-mousedown': 'mouseDown(true)',\n        'ng-mouseup': 'mouseDown(false)'\n      });\n      if (attrs.multiselect != null) {\n        select_menu.attr({\n          'multiple': 'true',\n          'on-select': 'onSelectMultiOption(selected)',\n          'on-discard': 'onDeselectMultiOption(discarded)',\n          'ng-show': 'show_select_menu'\n        });\n      }\n      shift_select_scope = scope.$new();\n      transclude(shift_select_scope, function(clone) {\n        return select_menu.append(clone);\n      });\n      element.append(select_menu);\n      $compile(select_menu)(shift_select_scope);\n      filterOptions = function() {\n        var filter;\n        if (scope.query) {\n          filter = {};\n          filter[scope.filterAttribute] = scope.query;\n          scope.options = $filter('filter')(scope.source, filter).slice(0, 6);\n          return scope.show_select_menu = true;\n        } else {\n          return scope.options = [];\n        }\n      };\n      mouse_down = false;\n      scope.mouseDown = function(is_down) {\n        return mouse_down = is_down;\n      };\n      scope.hide = function($event) {\n        if (!mouse_down) {\n          return scope.show_select_menu = false;\n        }\n      };\n      scope.onFocus = function($event) {\n        scope.show_select_menu = true;\n        if (scope.show_options_on_focus) {\n          if (scope.query) {\n            return filterOptions();\n          } else {\n            return scope.options = scope.source;\n          }\n        }\n      };\n      scope.onSelect = function(selected) {\n        scope.selected = selected;\n        return scope.query = selected != null ? selected[scope.filterAttribute] : void 0;\n      };\n      scope.$watch('query', function(new_value, old_value) {\n        var ref;\n        if (new_value === old_value) {\n          return;\n        }\n        if (attrs.multiselect == null) {\n          if (scope.query !== ((ref = scope.selected) != null ? ref[scope.filterAttribute] : void 0)) {\n            scope.selected = null;\n          }\n        }\n        return filterOptions();\n      });\n      onKeyUp = function(event) {\n        var key;\n        key = event.which || event.keyCode;\n        if (!scope.close_menu_on_esc) {\n          return;\n        }\n        if (key === 27 && scope.show_select_menu) {\n          event.stopPropagation();\n          return scope.$apply(function() {\n            return scope.show_select_menu = false;\n          });\n        }\n      };\n      onMouseDown = function(event) {\n        if (!scope.show_select_menu) {\n          return;\n        }\n        if (element.has(event.target).length) {\n          return;\n        }\n        scope.$apply(function() {\n          return scope.show_select_menu = false;\n        });\n      };\n      (startListening = function() {\n        document.addEventListener('keyup', onKeyUp);\n        if (attrs.multiselect != null) {\n          return document.addEventListener('mousedown', onMouseDown);\n        }\n      })();\n      stopListening = function() {\n        document.removeEventListener('keyup', onKeyUp);\n        return document.removeEventListener('mousedown', onMouseDown);\n      };\n      return scope.$on('$destroy', stopListening);\n    }\n  };\n}]);\n\n'use strict';\n\nangular.module('shift.components.typeahead').run(['$templateCache', function($templateCache) {\n\n  $templateCache.put('typeahead/typeahead.html', '<input type=\"text\" ng-blur=\"hide($event)\" ng-class=\"{\\'select-menu-visible\\': show_select_menu &amp;&amp; options.length}\" ng-focus=\"onFocus($event)\" ng-model=\"query\" placeholder=\"{{placeholder}}\">');\n\n}]);"],"sourceRoot":"/source/"}